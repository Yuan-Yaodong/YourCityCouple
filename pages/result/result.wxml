<!--pages/result/result.wxml-->
<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{!showResult}}" class="loading">
    <text>æ­£åœ¨è®¡ç®—ä½ çš„è¿åŠ¿...</text>
  </view>

  <!-- ç»“æœå†…å®¹ -->
  <view wx:else class="result-content">
    <!-- é¡¶éƒ¨è£…é¥° -->
    <view class="top-decor {{showAnimations ? 'fade-in' : ''}}">
      <text>ğŸ§§</text>
      <text>ğŸŠ</text>
      <text>ğŸ®</text>
    </view>

    <!-- ç»“æœæ ‡é¢˜ -->
    <view class="result-header {{showAnimations ? 'slide-up' : ''}}" style="animation-delay: 0.2s">
      <text class="result-label">ä½ çš„å¼€å¹´æ—ºåŸæ˜¯</text>
      <text class="result-emoji">{{cityDetail.emoji}}</text>
      <text class="result-city">{{result.city}}</text>
    </view>

    <!-- åŸå¸‚æè¿° -->
    <view class="city-card {{showAnimations ? 'slide-up' : ''}}" style="animation-delay: 0.4s">
      <text class="city-desc">{{cityDetail.description}}</text>

      <!-- æ ‡ç­¾ -->
      <view class="tags">
        <text wx:for="{{cityDetail.tags}}" wx:key="index" class="tag {{showAnimations ? 'fade-in' : ''}}" style="animation-delay: {{0.6 + index * 0.15}}s">
          {{item}}
        </text>
      </view>

      <!-- è¯¦ç»†ä»‹ç» -->
      <text class="city-detail {{showAnimations ? 'fade-in' : ''}}" style="animation-delay: {{0.6 + cityDetail.tags.length * 0.15}}s">{{cityDetail.detail}}</text>

      <!-- åˆ†ææ–‡æ¡ˆ -->
      <view wx:if="{{analysis}}" class="analysis-section {{showAnimations ? 'slide-up' : ''}}" style="animation-delay: {{0.6 + (cityDetail.tags.length + 1) * 0.15}}s">
        <view class="analysis-title">ä¸ºä»€ä¹ˆé€‚åˆä½ </view>
        <view class="analysis-item" wx:for="{{analysis.whyFit}}" wx:key="index">
          <text class="analysis-point">{{item.text}}</text>
          <text class="analysis-desc">{{item.desc}}</text>
        </view>
        <view class="analysis-summary">{{analysis.summary}}</view>
      </view>
    </view>

    <!-- æŒ‰é’®åŒºåŸŸ -->
    <view class="btn-area {{showAnimations ? 'slide-up' : ''}}" style="animation-delay: 0.8s">
      <button class="btn-share" bindtap="generatePoster">
        ğŸ–¼ï¸ ç”Ÿæˆæµ·æŠ¥
      </button>
      <button class="btn-copy" bindtap="copyResult">
        ğŸ“¤ åˆ†äº«ç»™æœ‹å‹
      </button>
      <button class="btn-restart" bindtap="restartTest">
        ğŸ”„ å†æµ‹ä¸€æ¬¡
      </button>
    </view>

    <!-- åº•éƒ¨è£…é¥° -->
    <view class="bottom-decor {{showAnimations ? 'fade-in' : ''}}" style="animation-delay: 1s">
      <text>ğŸ‡</text>
      <text>âœ¨</text>
      <text>ğŸ†</text>
    </view>
  </view>

  <!-- æµ·æŠ¥é¢„è§ˆå¼¹çª— -->
  <view class="poster-modal" wx:if="{{showPosterModal}}" bindtap="closePosterModal">
    <view class="poster-content" catchtap="preventClose">
      <image class="poster-image" src="{{posterImage}}" mode="widthFix"></image>
      <button class="btn-save" bindtap="savePosterToAlbum">ä¿å­˜åˆ°ç›¸å†Œ</button>
      <view class="close-hint">ç‚¹å‡»ç©ºç™½å¤„å…³é—­</view>
    </view>
  </view>

  <!-- éšè—çš„canvasç”¨äºç”Ÿæˆæµ·æŠ¥ -->
  <canvas canvas-id="posterCanvas" class="hide-canvas"></canvas>
</view>
